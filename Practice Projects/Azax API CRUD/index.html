<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Product List</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-slate-100">
    <div class="max-w-7xl mx-auto py-10">
      <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-slate-700">Product List</h1>
        <a
          href="create.html"
          class="bg-indigo-600 text-white px-5 py-2 rounded hover:bg-indigo-700"
          >+ Add Product</a
        >
      </div>

      <div class="bg-white rounded-lg shadow overflow-hidden">
        <table class="w-full">
            <thead class="bg-slate-200 text-slate-700">
                <tr>
                <th class="p-3 text-left">Product Name</th>
                <th class="p-3">Product Code</th>
                <th class="p-3">Unit Price</th>
                <th class="p-3">Qty</th>
                <th class="p-3">Total Price</th>
                <th class="p-3">Edit</th>
                <th class="p-3">Delete</th>
                </tr>
            </thead>
            <tbody id="products-data">
                
            </tbody>
        </table>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
    getProducts();
      async function getProducts() {
        let url = `https://crud.teamrabbil.com/api/v1/ReadProduct`;
        let response = await axios.get(url);
        let products = response.data["data"];

        products.forEach(product => {
            document.getElementById("products-data").innerHTML += (`
                <tr class="border-t hover:bg-slate-50">
                    <td class="p-3">${product['ProductName']}</td>
                    <td class="p-3 text-center">${product.ProductCode}</td>
                    <td class="p-3 text-center">${product['UnitPrice']}</td>
                    <td class="p-3 text-center">${product.Qty}</td>
                    <td class="p-3 text-center">${product['TotalPrice']}</td>
                    <td class="p-3 text-center space-x-2">
                        <button class="text-red-600 hover:underline" onclick="goToUpdateProduct('${product['_id']}')">
                            Edit
                        </button>
                    </td>
                    <td class="p-3 text-center space-x-2">
                        <button class="text-red-600 hover:underline" onclick="deleteProduct('${product._id}')">
                            Delete
                        </button> 
                    </td>
                </tr>
            `);
        });
        console.log(products)
      }

      async function deleteProduct(id) {
        let url = `https://crud.teamrabbil.com/api/v1/DeleteProduct/${id}`;
        let response = await axios.get(url);
        document.getElementById('products-data').innerHTML = '';
        getProducts();
      }

      function goToUpdateProduct(id){
        window.location = `update.html?id=${id}`;
      }
    </script>
  </body>
</html>
