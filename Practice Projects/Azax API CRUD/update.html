<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Update Product</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100">
    <div class="max-w-xl mx-auto py-10">
        <div class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-2xl font-semibold mb-6 text-slate-700">
                Update Product
            </h2>

            <div class="flex flex-col space-y-4">
                <div>
                    <label class="font-semibold" for="">Product Name</label>
                    <input type="text" placeholder="Product Name" class="w-full border p-2 rounded"
                        id="productNameID" />
                </div>

                <div>
                    <label class="font-semibold" for="">Product Code</label>
                    <input type="text" placeholder="Product Code" class="w-full border p-2 rounded"
                        id="productCodeID" />
                </div>

                <div>
                    <label class="font-semibold" for="">Unit Price</label>
                    <input type="number" placeholder="Unit Price" class="w-full border p-2 rounded" id="unitPriceID" />
                </div>

                <div>
                    <label class="font-semibold" for="">Quantity</label>
                    <input type="number" placeholder="Quantity" class="w-full border p-2 rounded" id="qtyID" />
                </div>

                <div>
                    <label class="font-semibold" for="">Total Price</label>
                    <input type="number" placeholder="Total Price" class="w-full border p-2 rounded"
                        id="totalPriceID" />
                </div>

                <button onclick="updateProduct()"
                    class="w-full bg-indigo-600 text-white py-2 rounded hover:bg-indigo-700">
                    Save Product
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        getProductInfo();
        async function getProductInfo() {
            let urlParam = new URLSearchParams(window.location.search);
            let id = urlParam.get("id");
            let url = `https://crud.teamrabbil.com/api/v1/ReadProductByID/${id}`;
            let response = await axios.get(url);
            let data = response.data["data"][0];

            document.getElementById("productNameID").value = data["ProductName"];
            document.getElementById("productCodeID").value = data["ProductCode"];
            document.getElementById("unitPriceID").value = data['UnitPrice'];
            document.getElementById("qtyID").value = data['Qty'];
            document.getElementById("totalPriceID").value = data["TotalPrice"];
        }

        async function updateProduct() {
            let urlParam = new URLSearchParams(window.location.search);
            let id = urlParam.get("id");

            let productNameValue = document.getElementById("productNameID").value;
            let productCodeValue = document.getElementById("productCodeID").value;
            let unitPriceValue = document.getElementById("unitPriceID").value;
            let quantityValue = document.getElementById("qtyID").value;
            let totalPriceValue = document.getElementById("totalPriceID").value;

            let obj = {
                'ProductName': productNameValue,
                'ProductCode': productCodeValue,
                'UnitPrice': unitPriceValue,
                'Qty': quantityValue,
                'TotalPrice': totalPriceValue,
            };

            let url = `https://crud.teamrabbil.com/api/v1/UpdateProduct/${id}`;
            let response = await axios.post(url, obj);
            window.location = "index.html";
        }
    </script>
</body>

</html>